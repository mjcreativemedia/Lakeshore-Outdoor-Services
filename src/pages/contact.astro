---
import Base from "../layouts/Base.astro";
import SEO from "../components/SEO.astro";
import JsonLd from "../components/JsonLd.astro";
import { BUSINESS } from "../data/business";
import { formatPhoneForDisplay } from "../utils/phone";

const title = "Get a snow quote";
const description =
  "Request fast snow removal pricing from Lakeshore Outdoor Services. Call us or send the form to get a tailored estimate.";
const canonical = new URL(Astro.url.pathname, BUSINESS.site).toString();
const phoneDisplay = formatPhoneForDisplay(BUSINESS.phone);
const businessAddress = {
  "@type": "PostalAddress",
  addressLocality: BUSINESS.address.city,
  addressRegion: BUSINESS.address.region,
  addressCountry: BUSINESS.address.country,
};

const schema: Record<string, unknown> = {
  "@context": "https://schema.org",
  "@type": ["LocalBusiness", "ServiceAreaBusiness"],
  "@id": `${BUSINESS.site}/#business`,
  name: BUSINESS.name,
  telephone: BUSINESS.phone,
  email: BUSINESS.email,
  url: canonical,
  description,
  address: businessAddress,
  areaServed: BUSINESS.areasServed,
  sameAs: [],
};
---
<Base title={title}>
  <SEO title={`${title} | ${BUSINESS.name}`} description={description} canonical={canonical} type="LocalBusiness" />
  <JsonLd schema={schema} />
  <section class="contact">
    <header>
      <h1>{title}</h1>
      <p>
        We’re a Chicago-based service-area business serving Hyde Park, South Shore, Bronzeville, Roseland, Pullman, Altgeld
        Gardens, Lakeview, Lincoln Park, Evanston, Wilmette, and Winnetka. Call us at
        <a href={`tel:${BUSINESS.phone}`}>{phoneDisplay}</a> or share the details below and we'll follow up with a custom snow
        removal quote.
      </p>
    </header>
    <form action="https://formspree.io/f/your-form-id" method="POST" class="form">
      <!-- Honeypot -->
      <input
        type="text"
        name="company"
        tabindex="-1"
        autocomplete="organization"
        style="position:absolute;left:-9999px"
        aria-hidden="true"
      />
      <!-- Redirect after submit -->
      <input type="hidden" name="_redirect" value="https://lakeshoreoutdoor.com/thank-you/" />
      <!-- Form name to group leads in Formspree -->
      <input type="hidden" name="_subject" value="Lakeshore Outdoor — New Lead" />
      <input type="hidden" name="page" id="contact-page-source" value="" />
      <label>
        <span>Name</span>
        <input type="text" name="name" required autocomplete="name" />
      </label>
      <label>
        <span>Phone</span>
        <input type="tel" name="phone" required autocomplete="tel" />
      </label>
      <label>
        <span>Service address</span>
        <input type="text" name="address" required autocomplete="street-address" />
      </label>
      <label>
        <span>Project details</span>
        <textarea name="message" rows="5" required placeholder="Tell us about your property and snow challenges"></textarea>
      </label>
      <button type="submit">Request my quote</button>
    </form>
    <script>
      const sourceField = document.getElementById("contact-page-source");
      if (sourceField) {
        sourceField.value = window.location.pathname;
      }
    </script>
  </section>
</Base>

<style>
  .contact {
    margin: 0 auto;
    max-width: 720px;
    padding: 3rem 1.5rem;
    display: grid;
    gap: 2rem;
  }

  header h1 {
    font-size: clamp(2rem, 3vw, 2.5rem);
    margin-bottom: 0.5rem;
  }

  header p {
    font-size: 1.1rem;
    line-height: 1.7;
    color: #1f2937;
  }

  header a {
    font-weight: 600;
  }

  .form {
    display: grid;
    gap: 1rem;
  }

  label {
    display: grid;
    gap: 0.5rem;
  }

  input,
  textarea {
    width: 100%;
    padding: 0.75rem 1rem;
    border-radius: 0.75rem;
    border: 1px solid #cbd5f5;
    font-size: 1rem;
    font-family: inherit;
    background: #fff;
  }

  textarea {
    resize: vertical;
  }

  button {
    padding: 0.85rem 1.5rem;
    border-radius: 999px;
    border: none;
    font-size: 1rem;
    font-weight: 600;
    background: #2563eb;
    color: #fff;
    cursor: pointer;
    transition: background 0.2s ease;
  }

  button:hover,
  button:focus {
    background: #1d4ed8;
  }
</style>
